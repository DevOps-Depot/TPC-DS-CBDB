-- start query 14 in stream 2 using template query28.tpl
select  *
from (select avg(ss_list_price) B1_LP
            ,count(ss_list_price) B1_CNT
            ,count(distinct ss_list_price) B1_CNTD
      from store_sales
      where ss_quantity between 0 and 5
        and (ss_list_price between 112 and 112+10 
             or ss_coupon_amt between 12526 and 12526+1000
             or ss_wholesale_cost between 78 and 78+20)) B1,
     (select avg(ss_list_price) B2_LP
            ,count(ss_list_price) B2_CNT
            ,count(distinct ss_list_price) B2_CNTD
      from store_sales
      where ss_quantity between 6 and 10
        and (ss_list_price between 15 and 15+10
          or ss_coupon_amt between 4995 and 4995+1000
          or ss_wholesale_cost between 29 and 29+20)) B2,
     (select avg(ss_list_price) B3_LP
            ,count(ss_list_price) B3_CNT
            ,count(distinct ss_list_price) B3_CNTD
      from store_sales
      where ss_quantity between 11 and 15
        and (ss_list_price between 50 and 50+10
          or ss_coupon_amt between 15440 and 15440+1000
          or ss_wholesale_cost between 5 and 5+20)) B3,
     (select avg(ss_list_price) B4_LP
            ,count(ss_list_price) B4_CNT
            ,count(distinct ss_list_price) B4_CNTD
      from store_sales
      where ss_quantity between 16 and 20
        and (ss_list_price between 52 and 52+10
          or ss_coupon_amt between 16346 and 16346+1000
          or ss_wholesale_cost between 3 and 3+20)) B4,
     (select avg(ss_list_price) B5_LP
            ,count(ss_list_price) B5_CNT
            ,count(distinct ss_list_price) B5_CNTD
      from store_sales
      where ss_quantity between 21 and 25
        and (ss_list_price between 114 and 114+10
          or ss_coupon_amt between 5973 and 5973+1000
          or ss_wholesale_cost between 40 and 40+20)) B5,
     (select avg(ss_list_price) B6_LP
            ,count(ss_list_price) B6_CNT
            ,count(distinct ss_list_price) B6_CNTD
      from store_sales
      where ss_quantity between 26 and 30
        and (ss_list_price between 98 and 98+10
          or ss_coupon_amt between 10841 and 10841+1000
          or ss_wholesale_cost between 13 and 13+20)) B6
limit 100;

-- end query 14 in stream 2 using template query28.tpl
